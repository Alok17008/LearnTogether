Index: app/src/main/java/com/collageproject/learntogether/Generativeai.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.collageproject.learntogether;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.recyclerview.widget.LinearLayoutManager;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport okhttp3.Call;\r\nimport okhttp3.Callback;\r\nimport okhttp3.MediaType;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\n\r\npublic class Generativeai extends AppCompatActivity {\r\n    RecyclerView recyclerView;\r\n    TextView welcomeTextView;\r\n    EditText messageEditText;\r\n    ImageButton sendButton;\r\n    List<Message> messageList;\r\n    MessageAdapter messageAdapter;\r\n    public static final MediaType JSON\r\n            = MediaType.get(\"application/json; charset=utf-8\");\r\n    OkHttpClient client = new OkHttpClient();\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_generativeai);\r\n        messageList = new ArrayList<>();\r\n\r\n        recyclerView = findViewById(R.id.recycler_view);\r\n        welcomeTextView = findViewById(R.id.welcome_text);\r\n        messageEditText = findViewById(R.id.message_edit_text);\r\n        sendButton = findViewById(R.id.send_btn);\r\n\r\n        //setup recycler view\r\n        messageAdapter = new MessageAdapter(messageList);\r\n        recyclerView.setAdapter(messageAdapter);\r\n        LinearLayoutManager llm = new LinearLayoutManager(this);\r\n        llm.setStackFromEnd(true);\r\n        recyclerView.setLayoutManager(llm);\r\n\r\n        sendButton.setOnClickListener((v)->{\r\n            String question = messageEditText.getText().toString().trim();\r\n            addToChat(question,Message.SENT_BY_ME);\r\n            messageEditText.setText(\"\");\r\n            callAPI(question);\r\n            welcomeTextView.setVisibility(View.GONE);\r\n        });\r\n    }\r\n\r\n    void addToChat(String message,String sentBy){\r\n        runOnUiThread(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                messageList.add(new Message(message,sentBy));\r\n                messageAdapter.notifyDataSetChanged();\r\n                recyclerView.smoothScrollToPosition(messageAdapter.getItemCount());\r\n            }\r\n        });\r\n    }\r\n\r\n    void addResponse(String response){\r\n        messageList.remove(messageList.size()-1);\r\n        addToChat(response,Message.SENT_BY_BOT);\r\n    }\r\n\r\n    void callAPI(String question){\r\n        //okhttp\r\n        messageList.add(new Message(\"Typing... \",Message.SENT_BY_BOT));\r\n\r\n        JSONObject jsonBody = new JSONObject();\r\n        try {\r\n            jsonBody.put(\"model\",\"text-davinci-003\");\r\n            jsonBody.put(\"prompt\",question);\r\n            jsonBody.put(\"max_tokens\",4000);\r\n            jsonBody.put(\"temperature\",0);\r\n        } catch (JSONException e) {\r\n            e.printStackTrace();\r\n        }\r\n        RequestBody body = RequestBody.create(jsonBody.toString(),JSON);\r\n        Request request = new Request.Builder()\r\n                .url(\"https://api.openai.com/v1/completions\")\r\n                .header(\"Authorization\",\"Bearer APIKEY\")\r\n                .post(body)\r\n                .build();\r\n\r\n        client.newCall(request).enqueue(new Callback() {\r\n            @Override\r\n            public void onFailure(@NonNull Call call, @NonNull IOException e) {\r\n                addResponse(\"Failed to load response due to \"+e.getMessage());\r\n            }\r\n\r\n            @Override\r\n            public void onResponse(@NonNull Call call, @NonNull Response response) throws IOException {\r\n                if(response.isSuccessful()){\r\n                    JSONObject  jsonObject = null;\r\n                    try {\r\n                        jsonObject = new JSONObject(response.body().string());\r\n                        JSONArray jsonArray = jsonObject.getJSONArray(\"choices\");\r\n                        String result = jsonArray.getJSONObject(0).getString(\"text\");\r\n                        addResponse(result.trim());\r\n                    } catch (JSONException e) {\r\n                        e.printStackTrace();\r\n                    }\r\n\r\n\r\n                }else{\r\n                    addResponse(\"Failed to load response due to \"+response.body().toString());\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/collageproject/learntogether/Generativeai.java b/app/src/main/java/com/collageproject/learntogether/Generativeai.java
--- a/app/src/main/java/com/collageproject/learntogether/Generativeai.java	(revision 907b96d38e8610605c2d8d745d0e1b79c93651cf)
+++ b/app/src/main/java/com/collageproject/learntogether/Generativeai.java	(date 1701452969737)
@@ -97,7 +97,7 @@
         RequestBody body = RequestBody.create(jsonBody.toString(),JSON);
         Request request = new Request.Builder()
                 .url("https://api.openai.com/v1/completions")
-                .header("Authorization","Bearer APIKEY")
+                .header("Authorization","Bearer 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")
                 .post(body)
                 .build();
 
